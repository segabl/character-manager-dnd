<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/solid.css" integrity="sha384-rdyFrfAIC05c5ph7BKz3l5NG5yEottvO/DQ0dCrwD8gzeQDjYBHNr1ucUpQuljos" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/fontawesome.css" integrity="sha384-u5J7JghGz0qUrmEsWzBQkfvc8nK3fUT7DCaQzNQ+q4oEXhGSx+P2OqjWsfIRB8QT" crossorigin="anonymous">

  <title>Dungeons & Dragons Character Manager</title>
</head>

<body class="bg-secondary">

<nav class="navbar navbar-expand-sm fixed-top navbar-dark bg-dark">
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav mr-auto">
      <li><a class="nav-link active" id="characterNav" href="#" onclick="switchView(this.id, 'characterView')"><i class="fas fa-user"></i>&nbsp;Character</a></li>
      <li><a class="nav-link" id="partyNav" href="#" onclick="switchView(this.id, 'partyView')"><i class="fas fa-users"></i>&nbsp;Party</a></li>
      <li><a class="nav-link" id="tableNav" href="#" onclick="switchView(this.id, 'tableView')"><i class="fas fa-rocket"></i>&nbsp;Table</a></li>
    </ul>
  </div>
</nav>

<br> <br> <br>

<!-- character container -->
<div class="container" id="characterView">
  <!-- name, level and exp -->
  <div class="row text-center text-light bg-dark">
    <h5 id="name" class="col" contenteditable="true">Name</h5>
  </div>
  <div class="row py-1 mb-2 text-center text-dark bg-light">
    <div class="col-sm-4 col-12" id="class">
      <strong contenteditable="true">Class</strong><br><small>Class</small>
    </div>
    <div class="col-sm-2 col-6" id="level">
      <strong contenteditable="true">0</strong><br><small>Level</small>
    </div>
    <div class="col-sm-2 col-6" id="hp">
      <strong contenteditable="true">0/0</strong><br><small>HP</small>
    </div>
    <div class="col-sm-2 col-6" id="hit_dice">
      <strong contenteditable="true">0/0</strong><br><small>Hit Dice</small>
    </div>
    <div class="col-sm-2 col-6" id="exp">
      <strong contenteditable="true">0</strong><br><small>EXP</small>
    </div>
  </div>

  <!-- stats -->
  <div class="row text-center text-light bg-dark">
    <h5 class="col">Stats</h5>
  </div>
  <div class="row py-1 mb-2 text-center text-dark bg-light">
    <div class="col" id="stat_armor_class">
      <strong contenteditable="true">0</strong><br><small>Armor Class</small>
    </div>
    <div class="col" id="stat_speed">
      <strong contenteditable="true">0</strong><br><small>Speed</small>
    </div>
    <div class="col" id="stat_passive_perception">
      <strong contenteditable="true">0</strong><br><small>Passive Perception</small>
    </div>
    <div class="col" id="stat_initiative">
      <strong contenteditable="true">0</strong><br><small>Initiative</small>
    </div>
    <div class="col" id="stat_proficiency_bonus">
      <strong contenteditable="true">0</strong><br><small>Proficiency Bonus</small>
    </div>
  </div>

  <!-- skills -->
  <div class="row text-center text-light bg-dark">
    <h5 class="col">Skills</h5>
  </div>
  <div class="row py-1 mb-2 text-center text-dark bg-light">
    <div class="col-md-2 col-sm-4 col-6 skill" id="skill_acrobatics">
      <strong>0</strong><br><small>Acrobatics</small>
    </div>
    <div class="col-md-2 col-sm-4 col-6 skill" id="skill_animal_handling">
      <strong>0</strong><br><small>Animal Handling</small>
    </div>
    <div class="col-md-2 col-sm-4 col-6 skill" id="skill_arcana">
      <strong>0</strong><br><small>Arcana</small>
    </div>
    <div class="col-md-2 col-sm-4 col-6 skill" id="skill_athletics">
      <strong>0</strong><br><small>Athletics</small>
    </div>
    <div class="col-md-2 col-sm-4 col-6 skill" id="skill_deception">
      <strong>0</strong><br><small>Deception</small>
    </div>
    <div class="col-md-2 col-sm-4 col-6 skill" id="skill_history">
      <strong>0</strong><br><small>History</small>
    </div>
    <div class="col-md-2 col-sm-4 col-6 skill" id="skill_insight">
      <strong>0</strong><br><small>Insight</small>
    </div>
    <div class="col-md-2 col-sm-4 col-6 skill" id="skill_intimidation">
      <strong>0</strong><br><small>Intimidation</small>
    </div>
    <div class="col-md-2 col-sm-4 col-6 skill" id="skill_investigation">
      <strong>0</strong><br><small>Investigation</small>
    </div>
    <div class="col-md-2 col-sm-4 col-6 skill" id="skill_medicine">
      <strong>0</strong><br><small>Medicine</small>
    </div>
    <div class="col-md-2 col-sm-4 col-6 skill" id="skill_nature">
      <strong>0</strong><br><small>Nature</small>
    </div>
    <div class="col-md-2 col-sm-4 col-6 skill" id="skill_perception">
      <strong>0</strong><br><small>Perception</small>
    </div>
    <div class="col-md-2 col-sm-4 col-6 skill" id="skill_performance">
      <strong>0</strong><br><small>Performance</small>
    </div>
    <div class="col-md-2 col-sm-4 col-6 skill" id="skill_persuasion">
      <strong>0</strong><br><small>Persuasion</small>
    </div>
    <div class="col-md-2 col-sm-4 col-6 skill" id="skill_religion">
      <strong>0</strong><br><small>Religion</small>
    </div>
    <div class="col-md-2 col-sm-4 col-6 skill" id="skill_sleight_of_hand">
      <strong>0</strong><br><small>Sleight of Hand</small>
    </div>
    <div class="col-md-2 col-sm-4 col-6 skill" id="skill_stealth">
      <strong>0</strong><br><small>Stealth</small>
    </div>
    <div class="col-md-2 col-sm-4 col-6 skill" id="skill_survival">
      <strong>0</strong><br><small>Survival</small>
    </div>
  </div>

  <!-- ability modifiers -->
  <div class="row text-center text-light bg-dark">
    <h5 class="col">Ability Modifiers</h5>
  </div>
  <div class="row py-1 mb-2 text-center text-dark bg-light">
    <div class="col-md-2 col-sm-4 col-6 ability" id="modifier_strength">
      <strong>0</strong><br><small>Strength</small>
    </div>
    <div class="col-md-2 col-sm-4 col-6 ability" id="modifier_dexterity">
      <strong>0</strong><br><small>Dexterity</small>
    </div>
    <div class="col-md-2 col-sm-4 col-6 ability" id="modifier_constitution">
      <strong>0</strong><br><small>Constitution</small>
    </div>
    <div class="col-md-2 col-sm-4 col-6 ability" id="modifier_intelligence">
      <strong>0</strong><br><small>Intelligence</small>
    </div>
    <div class="col-md-2 col-sm-4 col-6 ability" id="modifier_wisdom">
      <strong>0</strong><br><small>Wisdom</small>
    </div>
    <div class="col-md-2 col-sm-4 col-6 ability" id="modifier_charisma">
      <strong>0</strong><br><small>Charisma</small>
    </div>
  </div>

  <!-- inventory -->
  <div class="row text-center text-light bg-dark">
    <h5 class="col">Inventory</h5>
  </div>
  <div class="row py-1 text-center text-dark bg-light">
    <div class="col" id="inventory_pp">
      <strong contenteditable="true">0</strong><br><small>PP</small>
    </div>
    <div class="col" id="inventory_gp">
      <strong contenteditable="true">0</strong><br><small>GP</small>
    </div>
    <div class="col" id="inventory_ep">
      <strong contenteditable="true">0</strong><br><small>EP</small>
    </div>
    <div class="col" id="inventory_sp">
      <strong contenteditable="true">0</strong><br><small>SP</small>
    </div>
    <div class="col" id="inventory_cp">
      <strong contenteditable="true">0</strong><br><small>CP</small>
    </div>
  </div>
  <div id="inventory" class="row py-1 mb-2 text-center text-dark bg-light">

  </div>
</div>

<div class="container" id="partyView" style="display: none">
    PartyView
</div>

<div class="container" id="tableView" style="display: none">
    <label class="text-white" for="numberOfPlayersSelect">Number of players (Replace with party):</label>
    <select id="numberOfPlayersSelect" class="form-control">
        <option>1</option>
        <option>2</option>
        <option>3</option>
        <option>4</option>
        <option>5</option>
        <option>6</option>
        <option>7</option>
    </select>
    <br>

    <div id="playerTopRow" class="row py-1 mb-2 justify-content-center text-center text-dark">
    </div>
    <div class="row py-1 mb-2 text-center text-dark">
        <div class="col">
            <button id="addPlayerTopBtn" type="button" class="btn btn-light" onclick="addTopPlayer()"><i class="fas fa-plus"></i></button>
            <button id="delPlayerTopBtn" type="button" class="btn btn-light" onclick="delTopPlayer()"><i class="fas fa-minus"></i></button>
        </div>
    </div>
    <div class="row py-1 mb-2 text-center text-dark">
        <div id="playerLeftCol" class="col">  
        </div>
        <div class="col">
            <button id="addPlayerLeftBtn" type="button" class="btn btn-light" onclick="addLeftPlayer()"><i class="fas fa-plus"></i></button>
            <button id="delPlayerLeftBtn" type="button" class="btn btn-light" onclick="delLeftPlayer()"><i class="fas fa-minus"></i></button>
        </div>
        <div class="col" style="border-top: 2px solid white; border-left: 2px solid white; border-right: 2px solid white">&nbsp;</div>
        <div class="col">
            <button id="addPlayerRightBtn" type="button" class="btn btn-light" onclick="addRightPlayer()"><i class="fas fa-plus"></i></button>
            <button id="delPlayerRightBtn" type="button" class="btn btn-light" onclick="delRightPlayer()"><i class="fas fa-minus"></i></button>
        </div>
        <div id="playerRightCol" class="col">  
        </div>
    </div>
    <div class="row py-1 mb-2 text-center text-light">
        <div class="col">
            <strong>DM</strong>
        </div>
    </div>
</div>

<div class="modal" id="editModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title"></h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div id="attrValue">
          <label>Value</label>
          <input type="text" value="0">
        </div>
        <div id="proficiencyValue" style="display: none">
          <label>Proficient</label>
          <input type="checkbox" value="0">
        </div>
        <div id="accAttrValue">
          <label>Accumulated</label>
          <input type="text" value="0" readonly>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary">Save changes</button>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<script src="js/jquery-3.4.1.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/client.js"></script>
<script>
  connectToServer();
  $(".skill").click(function(event) {
    var id = event.target.id;
    if(event.target.id == null || event.target.id.length <= 0) {
      id = event.target.parentNode.id;
    }
    const skillName = $("#" + id + " > small").html();
    $(".modal-title").html(skillName);

    const skill = characters[myCharId].skills[id.replace("skill_", "")];
    const proficiencyBonus = characters[myCharId].stats.proficiency_bonus;
    $("#attrValue > input")[0].value = skill.value;
    $("#proficiencyValue")[0].style.display = "block";
    $("#proficiencyValue > input")[0].checked = skill.proficient;
    const accVal = skill.value + (skill.proficient ? proficiencyBonus : 0);
    $("#accAttrValue > input")[0].value = accVal;
    const editDialog = $("#editModal").modal('show');
  });
  $(".ability").click(function(event) {

    alert("ability");

  });
  $(".inventory").click(function(event) {

    alert("inventory");

  });
</script>
</body>
</html>